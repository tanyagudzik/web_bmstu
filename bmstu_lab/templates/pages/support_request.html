{% extends 'layouts/surface_base.html' %}
{% load static %}

{% block page_title %}Текущая заявка{% endblock %}
{% block surface_heading %}Текущая заявка{% endblock %}
{# Бейдж на этой странице НЕ показываем #}
{% block surface_badge %}{% endblock %}

{% block surface_content %}
  {% if not_found %}
    <p class="alert">Заявка не найдена.</p>
  {% else %}
  <section class="req">

    <div class="req__box">
      <dl class="req-meta">
        <div><dt>ID: </dt><dd>{{ req.id }}</dd></div>
        <div><dt>Статус: </dt><dd>{{ req.status }}</dd></div>
        <div><dt>Создатель: </dt><dd>{{ req.owner }}</dd></div>
        <div><dt>Помещение: </dt><dd>{{ req.room }}</dd></div>
        <div><dt>Создана: </dt><dd>{{ req.created }}</dd></div>
        <div><dt>Результат вычислений: </dt><dd>{{ req.calc_result|default:"—" }}</dd></div>
      </dl>
    </div>

    <div class="req__list">
      <table class="tbl">
        <thead>
          <tr>
            <th>Услуга</th>
            <th>Название</th>
            <th>Время</th>
            <th>Кол-во</th>
            <th>Порядок</th>
            <th>Главный</th>
            <th>Комментарий</th>
          </tr>
        </thead>
        <tbody>
        {% for line in req.lines %}
          <tr>
            <td>{{ line.service_id }}</td>
            <td>{{ line.title }}</td>
            <td>{{ line.eta }}</td>
            <td>{{ line.qty }}</td>
            <td>{{ line.order|default:"—" }}</td>
            <td>{% if line.main %}Да{% else %}Нет{% endif %}</td>
            <td>{{ line.comment|default:"—" }}</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

  </section>
  {% endif %}
{% endblock %}
