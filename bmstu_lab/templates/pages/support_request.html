{% extends 'layouts/surface_base.html' %}
{% load static %}

{% block page_title %}Текущая заявка{% endblock %}
{% block surface_heading %}Текущая заявка{% endblock %}
{# Бейдж на этой странице НЕ показываем #}
{% block surface_badge %}{% endblock %}

{% block surface_content %}
  {% if not_found %}
    <p class="alert">Заявка не найдена.</p>
  {% else %}
  <section class="req">

    <div class="req__box">
      <div class="card" style="padding: 16px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,.08);">
        <div><strong>Создана:</strong> {{ req.created_at|date:"d.m.Y H:i" }}</div>
        {% if req.room %}
          <div style="margin-top:6px;"><strong>Помещение:</strong> {{ req.room }}</div>
        {% endif %}
      </div>
    </div>

    <div class="req__list" style="margin-top: 16px;">

      {% for line in lines %}
        <div class="card" style="display:flex; gap:16px; align-items:flex-start; padding:16px; margin-bottom:12px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,.08);">
            <div style="flex:0 0 72px; display:flex; align-items:center; justify-content:center; margin-right:12px;">
              {% if line.support_service.img %}
                <img src="{% static line.support_service.img %}" alt="{{ line.support_service.title }}" style="width:72px; height:72px; object-fit:contain;">
              {% else %}
                <span style="font-size:12px; color:#8a8a8a;">нет фото</span>
              {% endif %}
            </div>
          <div style="flex:1;">
            <div style="font-weight:600; margin-bottom:4px;">{{ line.support_service.title }}</div>
            <div style="font-size:13px; color:#666; margin-bottom:6px;">Ожидание: {{ line.support_service.eta|default:"—" }}</div>
            {% if line.comment %}
              <div style="font-size:13px;"><strong>Комментарий:</strong> {{ line.comment }}</div>
            {% endif %}
          </div>
        </div>
      {% empty %}
        <p>Строк в заявке пока нет.</p>
      {% endfor %}
    </div>


  </section>
  {% endif %}
{% endblock %}
